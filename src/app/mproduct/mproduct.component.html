<h2>Product Management</h2>

<form [formGroup]="userForm" (ngSubmit)="submitForm()">
  <input formControlName="name" placeholder="Name" />
  <div *ngIf="userForm.controls['name'].invalid && userForm.controls['name'].touched">
    <small *ngIf="userForm.controls['name'].errors?.['required']">Name is required.</small>
    <small *ngIf="userForm.controls['name'].errors?.['minlength']">Min 3 characters.</small>
  </div>

  <input formControlName="email" placeholder="Email" />
  <div *ngIf="userForm.controls['email'].invalid && userForm.controls['email'].touched">
    <small *ngIf="userForm.controls['email'].errors?.['required']">Email is required.</small>
    <small *ngIf="userForm.controls['email'].errors?.['email']">Invalid email.</small>
  </div>

  <input type="file" (change)="onFileSelected($event)" />
  <div *ngIf="userForm.value.fileName">
    Selected: {{ userForm.value.fileName }}
  </div>

  <button type="submit">{{ editing ? 'Update' : 'Add' }}</button>
  <button type="button" (click)="resetForm()">Clear</button>
</form>

<input [(ngModel)]="searchTerm" placeholder="Search..." class="search-box" />

<ul>
  <li *ngFor="let user of filteredUsers">
    {{ user.name }} - {{ user.email }}
    <span *ngIf="user.fileName">
      | <a [href]="user.fileData" [download]="user.fileName">Download File</a>
    </span>
    <button (click)="edit(user)">Edit</button>
    <button (click)="delete(user.id)">Delete</button>
  </li>
</ul>

<div class="pagination-controls">
  <button (click)="prevPage()" [disabled]="page === 1">Prev</button>
  Page {{ page }}
  <button (click)="nextPage()" [disabled]="endIndex() >= filteredUsers.length">Next</button>
</div>